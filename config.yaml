# ================= بخش تولید سیگنال (نسخه جدید v2.0) =================
# تنظیمات معماری Orchestrator-Based با Context-Aware Analysis
signal_generation_v2:
  # کنترل کلی سیستم
  enabled: True                              # فعال/غیرفعال کردن معماری جدید
  use_legacy_fallback: True                  # استفاده از سیستم قدیمی در صورت خطا

  # تنظیمات اصلی تحلیل
  timeframes: ['5m', '15m', '1h', '4h']      # تایم‌فریم‌های مورد استفاده
  minimum_candles_required: 200              # حداقل تعداد کندل لازم برای تحلیل

  # تنظیمات IndicatorCalculator (محاسبه یکبار اندیکاتورها)
  indicator_calculator:
    enabled: True                            # فعال/غیرفعال کردن محاسبه مرکزی
    cache_indicators: True                   # کش کردن اندیکاتورها

    # Moving Averages
    moving_averages:
      ema_periods: [20, 50, 200]            # دوره‌های EMA
      sma_periods: [20, 50, 200]            # دوره‌های SMA

    # Oscillators
    oscillators:
      rsi_period: 14                        # دوره RSI
      macd_fast: 12                         # دوره سریع MACD
      macd_slow: 26                         # دوره کند MACD
      macd_signal: 9                        # دوره سیگنال MACD
      stochastic_k: 14                      # دوره K استوکستیک
      stochastic_d: 3                       # دوره D استوکستیک
      stochastic_smooth: 3                  # هموارسازی استوکستیک

    # Volatility Indicators
    volatility:
      atr_period: 14                        # دوره ATR
      bb_period: 20                         # دوره Bollinger Bands
      bb_std: 2                             # انحراف معیار BB

    # Volume Indicators
    volume:
      volume_sma_period: 20                 # دوره میانگین حجم
      obv_enabled: True                     # فعال کردن OBV

  # ===== تنظیمات Analyzers =====
  analyzers:
    # --- TrendAnalyzer ---
    trend_analyzer:
      enabled: True                          # فعال/غیرفعال کردن
      weight: 0.30                           # وزن در امتیازدهی نهایی

      # آستانه‌های قدرت روند
      strength_thresholds:
        strong: 3                            # روند قوی (3 EMA هم‌راستا)
        medium: 2                            # روند متوسط (2 EMA)
        weak: 1                              # روند ضعیف (1 EMA)

      # تشخیص فاز روند
      phase_detection:
        enabled: True                        # تشخیص فاز (starting/continuing/weakening)
        lookback_period: 10                  # تعداد کندل برای بررسی فاز

      # تشخیص pullback
      pullback_detection:
        enabled: True                        # تشخیص pullback در روند
        max_pullback_percent: 5              # حداکثر درصد pullback معتبر

    # --- MomentumAnalyzer ---
    momentum_analyzer:
      enabled: True
      weight: 0.25

      # تنظیمات RSI
      rsi:
        oversold_threshold: 30               # آستانه اشباع فروش
        overbought_threshold: 70             # آستانه اشباع خرید
        extreme_oversold: 20                 # آستانه اشباع فروش شدید
        extreme_overbought: 80               # آستانه اشباع خرید شدید

      # تنظیمات MACD
      macd:
        crossover_sensitivity: 0.5           # حساسیت تشخیص تقاطع
        histogram_threshold: 0               # آستانه هیستوگرام

      # تنظیمات Stochastic
      stochastic:
        oversold_threshold: 20
        overbought_threshold: 80
        cross_sensitivity: 2                 # حساسیت تقاطع K و D

      # تشخیص واگرایی
      divergence_detection:
        enabled: True                        # فعال کردن تشخیص واگرایی
        sensitivity: 0.75                    # حساسیت (0-1)
        peak_order: 3                        # پارامتر order تشخیص قله
        peak_distance: 5                     # حداقل فاصله بین قله‌ها
        min_peaks: 2                         # حداقل تعداد قله لازم
        hidden_divergence: True              # تشخیص واگرایی مخفی

      # Context-Aware Scoring
      context_aware:
        use_trend_context: True              # استفاده از Context روند
        bullish_trend_bonus: 0.3             # بونوس در روند صعودی
        bearish_trend_bonus: 0.3             # بونوس در روند نزولی

    # --- VolumeAnalyzer ---
    volume_analyzer:
      enabled: True
      weight: 0.15

      # آستانه‌های حجم
      volume_thresholds:
        high_volume_ratio: 1.5               # حجم بالا (1.5x میانگین)
        confirmation_ratio: 1.2              # حجم تاییدکننده
        low_volume_ratio: 0.8                # حجم پایین

      # تحلیل OBV
      obv_analysis:
        enabled: True                        # استفاده از OBV
        trend_period: 10                     # دوره بررسی روند OBV

      # Context-Aware
      context_aware:
        require_trend_confirmation: True     # نیاز به تایید با روند
        require_momentum_confirmation: True  # نیاز به تایید با مومنتوم
        both_required: False                 # هر دو الزامی (True) یا یکی کافی (False)

    # --- PatternAnalyzer ---
    pattern_analyzer:
      enabled: True
      weight: 0.10

      # الگوهای کندلی
      candlestick_patterns:
        enabled: True
        min_pattern_strength: 0.6            # حداقل قدرت الگو

        # امتیازهای الگوها (فقط مهم‌ترین‌ها - بقیه از config اصلی)
        bullish_engulfing: 1.25
        bearish_engulfing: 1.25
        morning_star: 1.5
        evening_star: 1.5
        three_white_soldiers: 1.6
        three_black_crows: 1.6

      # امتیازدهی خاص هر تایم‌فریم (اختیاری - برای قابلیت پیشرفته)
      # اگر این بخش را فعال کنید، الگوها در تایم‌فریم‌های مختلف امتیاز متفاوت خواهند داشت
      # اگر می‌خواهید از pattern_scores اصلی (بخش خط 440) استفاده کنید، این را خالی بگذارید
      pattern_scores_by_timeframe:
        # مثال:
        # hammer:
        #   '5m': 0.8
        #   '15m': 1.0
        #   '1h': 1.2
        #   '4h': 1.5
        # bullish_engulfing:
        #   '5m': 1.0
        #   '15m': 1.25
        #   '1h': 1.5
        #   '4h': 1.8

      # الگوهای چارتی
      chart_patterns:
        enabled: True
        min_quality: 0.7                     # حداقل کیفیت الگوی چارتی

      # Context-Aware Scoring
      context_aware:
        use_trend_alignment: True            # امتیازدهی بر اساس هم‌راستایی با روند
        trend_aligned_bonus: 0.5             # بونوس هم‌راستایی (50%)
        trend_opposed_penalty: 0.5           # جریمه ناهم‌راستایی (50%)

    # --- SRAnalyzer (Support/Resistance) ---
    sr_analyzer:
      enabled: True
      weight: 0.10

      # تشخیص سطوح
      detection:
        lookback_period: 50                  # دوره بررسی
        min_touches: 2                       # حداقل تعداد برخورد
        proximity_percent: 0.5               # فاصله نزدیکی (درصد)
        atr_multiplier: 1.0                  # ضریب ATR برای قدرت سطح

      # امتیازدهی
      scoring:
        near_support_bonus: 0.3              # بونوس نزدیکی به حمایت
        near_resistance_bonus: 0.3           # بونوس نزدیکی به مقاومت
        breakout_bonus: 0.5                  # بونوس شکست سطح

    # --- HarmonicAnalyzer ---
    harmonic_analyzer:
      enabled: False                         # غیرفعال به صورت پیش‌فرض (سنگین)
      weight: 0.05

      detection:
        lookback: 100
        tolerance: 0.03                      # تلرانس نسبت‌ها (3%)
        min_quality: 0.7

      patterns:
        gartley: True
        butterfly: True
        bat: True
        crab: True

    # --- ChannelAnalyzer ---
    channel_analyzer:
      enabled: True
      weight: 0.05

      detection:
        lookback: 100
        min_touches: 3                       # حداقل تعداد برخورد به کانال
        quality_threshold: 0.7

      scoring:
        channel_position_weight: 0.3         # وزن موقعیت در کانال
        breakout_bonus: 0.4                  # بونوس شکست کانال

    # --- CyclicalAnalyzer ---
    cyclical_analyzer:
      enabled: False                         # غیرفعال (محاسباتی سنگین)
      weight: 0.03

      detection:
        lookback: 200
        min_cycles: 2
        fourier_periods: [5, 10, 20, 40, 60]

    # --- VolatilityAnalyzer ---
    volatility_analyzer:
      enabled: True
      weight: 0.07

      thresholds:
        high_volatility: 1.5                 # نسبت ATR بالا
        low_volatility: 0.7                  # نسبت ATR پایین
        extreme_volatility: 1.8              # نسبت ATR خیلی بالا

      scoring:
        optimal_range_bonus: 0.2             # بونوس نوسان مطلوب
        high_volatility_penalty: 0.3         # جریمه نوسان بالا
        low_volatility_penalty: 0.2          # جریمه نوسان پایین

      filters:
        reject_extreme_volatility: True      # رد سیگنال در نوسان شدید

    # --- HTFAnalyzer (Higher Timeframe) ---
    htf_analyzer:
      enabled: True
      weight: 0.10

      # انتخاب تایم‌فریم بالاتر
      timeframe_selection:
        method: 'next_higher'                # 'next_higher' یا 'fixed'
        fixed_timeframes: ['1h', '4h']       # اگر method='fixed'

      # تحلیل ساختار
      structure_analysis:
        sr_lookback: 50
        sr_atr_multiplier: 1.0
        trend_indicator: 'ema'               # 'ema' یا 'sma'

      # امتیازدهی
      scoring:
        base_score: 1.0
        confirmation_bonus: 0.2              # بونوس تایید HTF
        trend_bonus_multiplier: 1.5          # ضریب بونوس هم‌جهتی روند
        contradiction_penalty: 0.3           # جریمه تضاد
        trend_penalty_multiplier: 1.5        # ضریب جریمه تضاد روند
        min_score: 0.5                       # حداقل امتیاز
        max_score: 1.5                       # حداکثر امتیاز

  # ===== تنظیمات SignalScorer (امتیازدهی) =====
  scoring:
    # وزن‌های پایه (از بخش analyzers استفاده می‌شود)
    # base_weights: (خودکار از وزن‌های analyzer ها)

    # ضرایب تایم‌فریم
    timeframe_weights:
      '5m': 0.7                              # وزن کمتر برای تایم‌فریم کوتاه
      '15m': 0.85
      '1h': 1.0                              # وزن استاندارد
      '4h': 1.2                              # وزن بیشتر برای تایم‌فریم بلند

    # بونوس‌های اضافی
    bonuses:
      volume_confirmation: 0.2               # بونوس تایید حجم (20%)
      trend_alignment: 0.3                   # بونوس هم‌راستایی روند (30%)
      multi_timeframe_confluence: 0.25       # بونوس هم‌سویی چند تایم‌فریم
      divergence_detected: 0.15              # بونوس شناسایی واگرایی

    # محاسبه امتیاز نهایی
    final_score_calculation:
      method: 'multiplicative'               # 'multiplicative' یا 'additive'
      cap_max_score: True                    # محدود کردن به 100
      min_score: 0                           # حداقل امتیاز ممکن
      max_score: 100                         # حداکثر امتیاز ممکن

  # ===== تنظیمات SignalValidator (اعتبارسنجی) =====
  validation:
    # آستانه‌های اصلی
    min_signal_score: 60                     # حداقل امتیاز برای قبول سیگنال
    strong_signal_threshold: 75              # آستانه سیگنال قوی

    # بررسی Risk/Reward
    risk_reward:
      enabled: True
      min_ratio: 2.0                         # حداقل نسبت R/R (1:2)
      preferred_ratio: 2.5                   # نسبت ترجیحی

    # فیلترهای اضافی
    filters:
      # Circuit Breaker
      check_circuit_breaker: True            # بررسی قطع‌کننده اضطراری

      # Correlation Management
      check_correlation: True                # بررسی همبستگی
      max_correlation: 0.7                   # حداکثر همبستگی مجاز
      max_correlated_trades: 2               # حداکثر تعداد معاملات همبسته

      # Portfolio Exposure
      check_portfolio_exposure: True         # بررسی میزان ریسک کل
      max_open_risk_percent: 10.0            # حداکثر ریسک باز (٪)

      # Volatility Check
      reject_extreme_volatility: True        # رد در نوسان شدید

    # اعتبارسنجی تایم‌فریم
    timeframe_validation:
      require_htf_confirmation: False        # نیاز به تایید HTF
      min_confirmed_timeframes: 2            # حداقل تعداد TF موافق

  # ===== تنظیمات Context Sharing =====
  context:
    # مدیریت نتایج
    max_results_history: 10                  # حداکثر تعداد نتایج قبلی ذخیره شده
    clear_context_between_symbols: True      # پاک کردن Context بین نمادها

    # اشتراک اطلاعات
    share_between_analyzers: True            # فعال کردن اشتراک‌گذاری
    allow_circular_references: False         # جلوگیری از وابستگی دایره‌ای

  # ===== تنظیمات عملکرد =====
  performance:
    # کش
    use_cache: True                          # فعال کردن کش
    cache_ttl_seconds: 60                    # زمان انقضای کش (ثانیه)

    # پردازش موازی
    parallel_analyzers: True                 # اجرای موازی Analyzer ها
    max_parallel_analyzers: 4                # حداکثر تعداد همزمان

    # بهینه‌سازی
    skip_disabled_analyzers: True            # رد Analyzer های غیرفعال
    early_exit_on_low_score: True            # خروج زودهنگام با امتیاز پایین
    early_exit_threshold: 30                 # آستانه خروج زودهنگام

  # ===== تنظیمات لاگینگ و دیباگ =====
  logging:
    enabled: True                            # فعال کردن لاگ اختصاصی
    log_level: 'INFO'                        # سطح لاگ
    log_analyzer_results: False              # لاگ نتایج هر Analyzer
    log_context_updates: False               # لاگ به‌روزرسانی Context
    log_performance_metrics: True            # لاگ معیارهای عملکرد

  # ===== تنظیمات آزمایشی =====
  experimental:
    # ویژگی‌های در حال توسعه
    use_ml_enhancement: False                # استفاده از ML برای بهبود (در آینده)
    adaptive_weights: False                  # تنظیم خودکار وزن‌ها
    context_learning: False                  # یادگیری از Context




# ================= بخش تنظیمات Exchange Client =================
# اطلاعات اتصال به API صرافی (مثال: KuCoin Futures)
exchange:
  api_key: 'YOUR_KUCOIN_FUTURES_API_KEY'     # کلید API شما
  api_secret: 'YOUR_KUCOIN_FUTURES_API_SECRET' # کلید Secret شما
  api_passphrase: 'YOUR_KUCOIN_FUTURES_API_PASSPHRASE' # رمز عبور API شما
  api_version: '2'                             # نسخه API (معمولا '2' برای KuCoin)
  base_url: 'https://api-futures.kucoin.com' # آدرس پایه API فیوچرز
  websocket:                                  # تنظیمات ارتباط وب‌سوکت برای دریافت داده‌های زنده
    enabled: True                            # فعال/غیرفعال کردن کلی WebSocket (برای دریافت آنی قیمت و ...)
    ping_interval: 20                       # فاصله زمانی (ثانیه) برای بررسی فعال بودن اتصال WebSocket (اگر کلاینت خودش پینگ نفرسته)
    auto_reconnect: True                     # تلاش مجدد خودکار در صورت قطع شدن WebSocket

# ================= بخش دریافت داده‌ها =================
# تنظیمات مربوط به نحوه دریافت و مدیریت داده‌های بازار
data_fetching:
  market_type: 'futures'                      # نوع بازار ('futures' یا 'spot') - فعلا فقط فیوچرز پیاده‌سازی شده
  primary_api: 'kucoin'                      # نام API اصلی که ExchangeClient از آن استفاده می‌کند
  max_symbols: 0                             # حداکثر تعداد نمادها برای پردازش (0 = بدون محدودیت)
  auto_symbols: True                         # دریافت خودکار لیست نمادهای فعال از صرافی
  fallback_apis: []                          # لیست APIهای پشتیبان (در حال حاضر استفاده نمی‌شود)
  timeframes: [ '5m','15m','1h', '4h']      # تایم‌فریم‌های اصلی مورد نیاز ربات
  max_concurrent_fetches: 10                 # حداکثر تعداد درخواست همزمان برای دریافت داده
  rate_limits:                               # اطلاعات حد نرخ درخواست (بیشتر جنبه اطلاعاتی دارد)
    requests_per_second: 5                   # حداکثر تعداد درخواست در هر ثانیه به API صرافی
  delta_updates:                             # تنظیمات دریافت فقط کندل‌های جدید (به جای کل داده‌ها)
    enabled: True                            # فعال کردن دریافت به‌روزرسانی‌های دلتا
    smart_caching: True                      # استفاده از زمان انقضای کش هوشمند (تا کندل بعدی)
  cache:                                     # تنظیمات کش کردن داده‌های OHLCV
    use_redis: True                          # استفاده از کش Redis (دیتابیس در حافظه سریع)
    use_memory_cache: True                   # استفاده از کش در حافظه RAM (سریع‌تر، ولی موقت)
    expiry_seconds:                          # زمان انقضای کش (ثانیه) برای هر تایم‌فریم (اگر smart_caching غیرفعال باشد)
      '5m': 300                              # کندل‌های 5 دقیقه‌ای به مدت 5 دقیقه کش می‌شوند
      '15m': 900                             # کندل‌های 15 دقیقه‌ای به مدت 15 دقیقه کش می‌شوند
      '1h': 3600                             # کندل‌های 1 ساعته به مدت 1 ساعت کش می‌شوند
      '4h': 14400                            # کندل‌های 4 ساعته به مدت 4 ساعت کش می‌شوند
    redis:                                   # تنظیمات اتصال به Redis
      host: 'localhost'                      # آدرس سرور Redis
      port: 6379                             # پورت سرور Redis
      db: 0                                  # شماره دیتابیس Redis
      path: null                             # مسیر سوکت Unix برای Redis (اختیاری، جایگزین host/port)
      password: null                         # رمز عبور Redis (اگر وجود دارد)
  use_mock_data: False                       # استفاده از داده‌های ساختگی برای تست (به جای داده‌های واقعی)

# ================= بخش استراتژی Ensemble =================
# تنظیمات مربوط به ترکیب چند استراتژی برای تولید سیگنال قوی‌تر
ensemble_strategy:
  enabled: False                             # فعال/غیرفعال کردن استراتژی ترکیبی
  voting_threshold: 0.6                      # حداقل نسبت رای وزنی برای تایید یک جهت (مثلا 60%)
  min_strategies_agreement: 2                # حداقل تعداد استراتژی‌هایی که باید روی یک جهت توافق کنند
  trend_strategy_weight: 1.2                 # وزن استراتژی دنبال‌کننده روند در رای‌گیری
  mean_reversion_strategy_weight: 1.0        # وزن استراتژی بازگشت به میانگین
  breakout_strategy_weight: 1.1              # وزن استراتژی شکست

# ================= بخش تولید سیگنال =================
# تنظیمات مربوط به نحوه تحلیل داده‌ها و تولید سیگنال‌های معاملاتی
signal_generation:
  minimum_signal_score: 46                # حداقل امتیاز نهایی برای معتبر بودن یک سیگنال
  strong_signal_score: 44                 # آستانه امتیاز برای سیگنال‌های "قوی" (برای کاربردهای آتی)
  timeframes:  [ '5m','15m','1h', '4h']   # تایم‌فریم‌هایی که در تحلیل چندتایم‌فریمی استفاده می‌شوند
  timeframe_weights:                      # ضریب اهمیت تحلیل هر تایم‌فریم در امتیاز نهایی
    '5m': 0.7                            # وزن کمتر برای تایم‌فریم‌های کوتاه‌مدت
    '15m': 0.85                          # وزن متوسط برای تایم‌فریم میان‌مدت
    '1h': 1.0                            # وزن استاندارد برای تایم‌فریم یک ساعته
    '4h': 1.2                            # وزن بیشتر برای تایم‌فریم‌های بلندمدت
  volume_multiplier_threshold: 1.3           # نسبت حجم فعلی به میانگین متحرک حجم برای تایید با حجم
  volume_confirmation_weight: 1.0            # ضریب اعمالی به امتیاز در صورت تایید با حجم
  divergence_sensitivity: 0.75               # حساسیت تشخیص واگرایی (تنظیم دقت شناسایی واگرایی‌ها)
  peak_detection_order: 3                    # پارامتر order برای تشخیص قله/دره (تعداد کندل همسایه)
  peak_detection_distance: 5                 # حداقل فاصله (تعداد کندل) بین قله‌ها/دره‌ها
  # وزن‌های پایه برای انواع تحلیل (قابل تغییر توسط رژیم بازار)
  trend_following_weight: 1.0                # وزن تحلیل‌های مبتنی بر ادامه روند
  reversal_weight: 1.0                       # وزن تحلیل‌های مبتنی بر بازگشت روند
  trend_alignment_weight: 1.0                # وزن هم‌راستایی روند در تایم‌فریم‌های مختلف
  # امتیاز پایه برای الگوها و رویدادهای مختلف شناسایی شده

# ================= بخش امتیازدهی به الگوهای معاملاتی =================
# نسخه جدید: امتیازدهی خاص هر تایم‌فریم
# هر الگو می‌تواند برای هر تایم‌فریم امتیاز متفاوتی داشته باشد
# الگوها در تایم‌فریم‌های بلندتر معمولاً قابل اعتمادتر هستند
pattern_scores:
  # --- الگوهای کندل استیک ---
  hammer:                                   # الگوی چکش (نشانه‌ای از تغییر روند نزولی به صعودی)
    '5m': 0.8                              # ضعیف‌تر در تایم‌فریم کوتاه
    '15m': 1.0                             # متوسط
    '1h': 1.2                              # قوی‌تر در تایم‌فریم بلند
    '4h': 1.5                              # بسیار قوی در تایم‌فریم بلند

  inverted_hammer:                          # الگوی چکش معکوس (نشانه احتمالی برگشت روند)
    '5m': 0.6
    '15m': 0.75
    '1h': 0.9
    '4h': 1.1

  bullish_engulfing:                        # الگوی دربرگیرنده صعودی (سیگنال قوی برگشت به روند صعودی)
    '5m': 1.0
    '15m': 1.25
    '1h': 1.5
    '4h': 1.8

  piercing_line:                            # الگوی خط نفوذی (سیگنال برگشت به روند صعودی)
    '5m': 0.7
    '15m': 0.9
    '1h': 1.1
    '4h': 1.3

  morning_star:                             # الگوی ستاره صبحگاهی (قوی‌ترین الگوی برگشتی صعودی)
    '5m': 1.2
    '15m': 1.5
    '1h': 1.8
    '4h': 2.2

  three_white_soldiers:                     # الگوی سه سرباز سفید (سیگنال قوی ادامه روند صعودی)
    '5m': 1.3
    '15m': 1.6
    '1h': 2.0
    '4h': 2.5

  dragonfly_doji:                           # الگوی دوجی سنجاقک (نشانه تعادل با تمایل به صعود)
    '5m': 0.6
    '15m': 0.75
    '1h': 0.9
    '4h': 1.1

  hanging_man:                              # الگوی مرد آویزان (نشانه پایان روند صعودی)
    '5m': 0.7
    '15m': 0.85
    '1h': 1.0
    '4h': 1.2

  shooting_star:                            # الگوی ستاره دنباله‌دار (نشانه پایان روند صعودی)
    '5m': 0.7
    '15m': 0.85
    '1h': 1.0
    '4h': 1.2

  bearish_engulfing:                        # الگوی دربرگیرنده نزولی (سیگنال قوی برگشت به روند نزولی)
    '5m': 1.0
    '15m': 1.25
    '1h': 1.5
    '4h': 1.8

  dark_cloud_cover:                         # الگوی ابر سیاه (سیگنال برگشت به روند نزولی)
    '5m': 0.8
    '15m': 1.0
    '1h': 1.2
    '4h': 1.5

  evening_star:                             # الگوی ستاره عصرگاهی (سیگنال قوی برگشت به روند نزولی)
    '5m': 1.2
    '15m': 1.5
    '1h': 1.8
    '4h': 2.2

  three_black_crows:                        # الگوی سه کلاغ سیاه (سیگنال قوی ادامه روند نزولی)
    '5m': 1.3
    '15m': 1.6
    '1h': 2.0
    '4h': 2.5

  gravestone_doji:                          # الگوی دوجی سنگ قبر (نشانه تعادل با تمایل به نزول)
    '5m': 0.6
    '15m': 0.75
    '1h': 0.9
    '4h': 1.1

  bullish_harami:                           # الگوی هارامی صعودی (نشانه تغییر روند به صعودی)
    '5m': 0.7
    '15m': 0.85
    '1h': 1.0
    '4h': 1.2

  bearish_harami:                           # الگوی هارامی نزولی (نشانه تغییر روند به نزولی)
    '5m': 0.7
    '15m': 0.85
    '1h': 1.0
    '4h': 1.2

  doji:                                     # الگوی دوجی (نشانه تردید و تعادل در بازار)
    '5m': 0.2
    '15m': 0.25
    '1h': 0.3
    '4h': 0.35

  # --- اندیکاتورهای تکنیکال ---
  macd_bullish_crossover:                   # تقاطع صعودی MACD (سیگنال خرید)
    '5m': 1.8
    '15m': 2.0
    '1h': 2.2
    '4h': 2.6

  macd_bearish_crossover:                   # تقاطع نزولی MACD (سیگنال فروش)
    '5m': 1.8
    '15m': 2.0
    '1h': 2.2
    '4h': 2.6

  macd_bullish_zero_cross:                  # عبور صعودی MACD از صفر (تأیید روند صعودی)
    '5m': 1.5
    '15m': 1.8
    '1h': 2.0
    '4h': 2.3

  macd_bearish_zero_cross:                  # عبور نزولی MACD از صفر (تأیید روند نزولی)
    '5m': 1.5
    '15m': 1.8
    '1h': 2.0
    '4h': 2.3

  rsi_oversold_reversal:                    # برگشت RSI از ناحیه اشباع فروش
    '5m': 1.8
    '15m': 2.0
    '1h': 2.3
    '4h': 2.8

  rsi_overbought_reversal:                  # برگشت RSI از ناحیه اشباع خرید
    '5m': 1.8
    '15m': 2.0
    '1h': 2.3
    '4h': 2.8

  rsi_bullish_divergence:                   # واگرایی مثبت RSI (سیگنال صعودی قوی)
    '5m': 3.0
    '15m': 3.5
    '1h': 3.8
    '4h': 4.5

  rsi_bearish_divergence:                   # واگرایی منفی RSI (سیگنال نزولی قوی)
    '5m': 3.0
    '15m': 3.5
    '1h': 3.8
    '4h': 4.5

  rsi_hidden_bullish_divergence:            # واگرایی مخفی مثبت RSI (تأیید ادامه روند صعودی)
    '5m': 2.5
    '15m': 3.0
    '1h': 3.3
    '4h': 3.8

  rsi_hidden_bearish_divergence:            # واگرایی مخفی منفی RSI (تأیید ادامه روند نزولی)
    '5m': 2.5
    '15m': 3.0
    '1h': 3.3
    '4h': 3.8

  stochastic_oversold_bullish_cross:        # تقاطع صعودی استوکستیک در ناحیه اشباع فروش
    '5m': 2.0
    '15m': 2.5
    '1h': 2.8
    '4h': 3.2

  stochastic_overbought_bearish_cross:      # تقاطع نزولی استوکستیک در ناحیه اشباع خرید
    '5m': 2.0
    '15m': 2.5
    '1h': 2.8
    '4h': 3.2

  # --- حمایت و مقاومت ---
  broken_resistance:                        # شکست سطح مقاومت (سیگنال صعودی قوی)
    '5m': 2.5
    '15m': 2.8
    '1h': 3.0
    '4h': 3.5

  broken_support:                           # شکست سطح حمایت (سیگنال نزولی قوی)
    '5m': 2.5
    '15m': 2.8
    '1h': 3.0
    '4h': 3.5

# ================= بخش تشخیص رژیم بازار =================
# تنظیمات مربوط به تشخیص وضعیت بازار و تطبیق استراتژی‌ها
market_regime:
  enabled: True                            # فعال/غیرفعال کردن تشخیص رژیم بازار
  adx_period: 14                           # تعداد کندل‌ها برای محاسبه شاخص ADX (شاخص قدرت روند)
  volatility_period: 20                    # تعداد کندل‌ها برای محاسبه ATR (شاخص نوسان)
  strong_trend_threshold: 25               # حداقل مقدار ADX برای تشخیص روند قوی (بالاتر = روند قوی‌تر)
  weak_trend_threshold: 20                 # حداقل مقدار ADX برای تشخیص روند ضعیف
  high_volatility_threshold: 1.5           # نسبت ATR به قیمت برای تشخیص نوسان بالا (درصد)
  low_volatility_threshold: 0.5            # نسبت ATR به قیمت برای تشخیص نوسان پایین (درصد)
  adapt_strategy: True                     # فعال کردن تغییر خودکار پارامترهای استراتژی بر اساس رژیم بازار

# ================= بخش پردازش سیگنال =================
# تنظیمات مربوط به مدیریت و اعتبارسنجی سیگنال‌های معاملاتی تولید شده
signal_processing:
  symbols: []                                # لیست خاص نمادها برای پردازش (خالی = استفاده از نمادهای خودکار)
  auto_forward_signals: True                 # ارسال خودکار سیگنال‌های معتبر به سیستم معاملات
  signal_max_age_minutes: 30                 # حداکثر عمر مجاز یک سیگنال قبل از منقضی شدن (دقیقه)
  check_incomplete_interval: 60              # فاصله زمانی بررسی مجدد نمادهایی با داده ناقص (ثانیه)
  ohlcv_limit_per_tf: 500                    # تعداد کندل درخواستی برای هر تایم‌فریم از MarketDataFetcher
  use_ensemble_strategy: True                # استفاده از استراتژی ترکیبی به جای استراتژی ساده
  notification:                              # تنظیمات اعلان‌های مربوط به سیگنال‌ها
    enabled: True                            # فعال/غیرفعال کردن اعلان برای سیگنال‌ها
    min_score_to_notify: 69.0                # حداقل امتیاز سیگنال برای ارسال اعلان

# ================= کش امتیازات تایم‌فریم =================
# سیستم کش هوشمند برای جلوگیری از محاسبات تکراری
# این سیستم امتیازات هر تایم‌فریم را ذخیره می‌کند و فقط زمانی که
# کندل جدیدی در تایم‌فریم ایجاد شده، دوباره محاسبه می‌کند
timeframe_score_cache:
  enabled: True                              # فعال/غیرفعال کردن سیستم کش
  max_cache_age_hours: 24                    # حداکثر عمر کش (ساعت) - بعد از این مدت حتی بدون کندل جدید، دوباره محاسبه می‌شود

# مزایای این سیستم:
# 1. کاهش 70-90% محاسبات غیرضروری
# 2. صرفه‌جویی در مصرف CPU و API calls
# 3. افزایش سرعت پردازش
# 4. حفظ کامل دقت تحلیل
#
# مثال:
#   - تایم‌فریم 4h فقط هر 4 ساعت یکبار دوباره محاسبه می‌شود
#   - تایم‌فریم 15m فقط هر 15 دقیقه یکبار دوباره محاسبه می‌شود
#   - در صورت عدم وجود کندل جدید، از امتیاز کش شده استفاده می‌شود

# ================= بخش معاملات =================
# تنظیمات مربوط به اجرای معاملات و مدیریت پوزیشن‌های باز
trading:
  mode: 'simulation'                         # حالت ربات: 'simulation' (شبیه‌سازی) یا 'live' (واقعی)
  auto_update_prices: True                   # به‌روزرسانی خودکار قیمت‌ها برای معاملات باز
  price_update_interval: 10                  # فاصله زمانی بررسی قیمت‌ها برای حد ضرر/سود (ثانیه)
  multi_tp:                                  # تنظیمات حد سود چندمرحله‌ای
    enabled: False                            # فعال/غیرفعال کردن خروج تدریجی از معامله با چند حد سود

# ================= بخش مدیریت ریسک =================
# پارامترهای کلیدی برای کنترل ریسک و مدیریت سرمایه
risk_management:
  account_balance: 10000.0                   # موجودی حساب برای محاسبات ریسک (USDT)
  account_risk_multiplier: 1.0               # ضریب کلی ریسک حساب (کمتر = ریسک کمتر)
  max_risk_per_trade_percent: 1.5            # حداکثر درصد ریسک سرمایه در هر معامله (٪)
  max_risk_per_symbol_percent: 5.0           # حداکثر درصد ریسک سرمایه روی یک نماد خاص (٪)
  max_daily_risk_percent: 5.0                # حداکثر درصد ریسک روزانه قابل قبول (٪)
  max_open_risk_percent: 10.0                # حداکثر درصد ریسک همزمان در کل معاملات باز (٪)
  max_open_trades: 10                        # حداکثر تعداد معاملات باز همزمان
  max_trades_per_symbol: 1                   # حداکثر تعداد معاملات باز همزمان روی یک نماد
  min_risk_reward_ratio: 3.0                 # حداقل نسبت ریسک به پاداش برای ورود به معامله
  preferred_risk_reward_ratio: 2.5           # نسبت ریسک به پاداش ترجیحی برای تنظیم حد سود

  # تنظیمات بررسی همبستگی نمادها
  use_correlation_check: True                # فعال کردن بررسی همبستگی قبل از معامله جدید
  max_correlation_threshold: 0.7             # حداکثر همبستگی مجاز با معاملات باز (0 تا 1)
  max_correlated_trades: 2                   # حداکثر تعداد معاملات همبسته مجاز
  correlation_timeframe: '4h'                # تایم‌فریم محاسبه همبستگی
  correlation_period: 100                    # تعداد کندل‌ها برای محاسبه همبستگی

  # تنظیمات حد ضرر متحرک
  use_trailing_stop: True                    # فعال کردن حد ضرر متحرک (دنباله‌رو)
  trailing_stop_activation_percent: 3.0      # درصد سود لازم برای فعال شدن حد ضرر متحرک
  trailing_stop_distance_percent: 2.25       # فاصله درصدی حد ضرر متحرک از قیمت
  use_atr_based_trailing: True               # استفاده از شاخص ATR برای تنظیم فاصله حد ضرر
  atr_trailing_multiplier: 2.25              # ضریب ATR برای تعیین فاصله حد ضرر متحرک
  atr_trailing_period: 21                    # دوره زمانی محاسبه ATR (تعداد کندل)
  use_structure_based_stops: False           # استفاده از سطوح مهم (سقف/کف) برای تعیین حد ضرر
  swing_detection_lookback: 21               # دوره زمانی تشخیص سقف/کف‌ها (تعداد کندل)
  use_time_based_stops: False                # فعال کردن خروج از معامله بر اساس زمان
  max_trade_duration_hours: 48               # حداکثر زمان مجاز یک معامله باز (ساعت)

  # تنظیمات اندازه پوزیشن (حجم معامله)
  use_dynamic_position_sizing: True          # محاسبه پویای حجم معامله بر اساس ریسک و شرایط
  drawdown_protection: True                  # کاهش ریسک در زمان ضرر مداوم (Drawdown)
  max_drawdown_percent: 20.0                 # آستانه درصد افت سرمایه برای شروع حفاظت
  winning_streak_factor: 1.1                 # ضریب افزایش ریسک به ازای هر برد متوالی
  losing_streak_factor: 0.9                  # ضریب کاهش ریسک به ازای هر باخت متوالی
  max_risk_increase: 1.5                     # حداکثر ضریب افزایش ریسک نسبت به حالت پایه
  kelly_fraction: 0.5                        # ضریب محافظه‌کاری در فرمول کلی (0-1)

  # سایر قوانین مدیریت ریسک
  allow_opposite_trades: False               # اجازه معاملات همزمان در جهت مخالف روی یک نماد
  fixed_position_size: 200                   # حجم ثابت معاملات (USDT) - جایگزین محاسبه پویا
  max_position_size: 200                     # حداکثر اندازه مجاز پوزیشن (USDT)
  default_stop_loss_percent: 3               # درصد حد ضرر پیش‌فرض اگر سایر روش‌ها کار نکنند

  # تنظیمات همبستگی با بیت‌کوین
  btc_correlation:
    consider_btc_trend: true                 # در نظر گرفتن روند بیت‌کوین در تصمیم‌گیری
    btc_symbol: "BTCUSDT"                    # نماد بیت‌کوین برای تحلیل همبستگی

    # تنظیمات تایم‌فریم‌های تحلیل همبستگی
    correlation_timeframes: ["15m", "1h", "4h", "1d"]  # تایم‌فریم‌های محاسبه همبستگی
    correlation_timeframe_weights: [0.1, 0.2, 0.3, 0.4]  # وزن هر تایم‌فریم (باید مجموع 1 باشد)
    primary_correlation_timeframe: "1h"      # تایم‌فریم اصلی برای محاسبه همبستگی
    correlation_period: 100                  # تعداد کندل‌ها برای محاسبه همبستگی

    # آستانه‌های همبستگی
    inverse_correlation_threshold: -0.2      # آستانه همبستگی معکوس
    zero_correlation_threshold: 0.2          # آستانه عدم همبستگی
    strong_correlation_threshold: 0.4        # آستانه همبستگی قوی

    # تنظیمات تحلیل تاخیر (تاثیر حرکت بیت‌کوین با تاخیر روی آلت‌کوین‌ها)
    analyze_lag_correlation: true            # بررسی همبستگی با تاخیر زمانی
    max_lag_periods: 5                       # حداکثر دوره‌های تاخیر برای بررسی

    # تنظیمات تحلیل روند بیت‌کوین
    btc_trend_timeframe: "4h"                # تایم‌فریم تشخیص روند بیت‌کوین
    btc_trend_period: 50                     # دوره زمانی تشخیص روند (تعداد کندل)
    btc_trend_ema_fast: 20                   # دوره میانگین متحرک نمایی سریع
    btc_trend_ema_slow: 50                   # دوره میانگین متحرک نمایی کند
    btc_trend_strength_threshold: 0.01       # آستانه قدرت روند (فاصله دو میانگین متحرک)

    # تنظیمات تحلیل حجم معاملات بیت‌کوین
    analyze_btc_volume: true                 # تحلیل حجم معاملات بیت‌کوین
    btc_volume_timeframe: "1d"               # تایم‌فریم تحلیل حجم
    btc_volume_period: 20                    # دوره زمانی میانگین حجم (تعداد کندل)
    btc_high_volume_threshold: 1.5           # ضریب تشخیص حجم بالا نسبت به میانگین

    # زمان انقضای کش (به ثانیه)
    correlation_cache_expiry_seconds: 3600   # انقضای کش داده‌های همبستگی (1 ساعت)
    btc_trend_cache_expiry: 1800             # انقضای کش داده‌های روند (30 دقیقه)
    btc_volume_cache_expiry: 1800            # انقضای کش داده‌های حجم (30 دقیقه)

# ================= بخش آزمایش برگشتی (Backtest) =================
# تنظیمات مربوط به اجرای بک‌تست و ارزیابی استراتژی روی داده‌های تاریخی
backtest:
  results_dir: 'backtest_results'            # پوشه ذخیره نتایج بک‌تست
  commission_rate: 0.0006                    # نرخ کارمزد در هر سمت معامله (0.0006 = 0.06%)
  slippage: 0.0005                           # میزان لغزش قیمت فرضی در ورود/خروج (0.0005 = 0.05%)
  parameters_to_test:                        # لیست پارامترهایی که در Grid Search بک‌تست می‌شوند
    - 'signal_generation.minimum_signal_score'
    - 'risk_management.max_risk_per_trade_percent'
    - 'risk_management.trailing_stop_distance_percent'
    - 'risk_management.atr_trailing_multiplier'
  parallel_backtests: True                   # اجرای موازی بک‌تست‌ها (استفاده از چند هسته CPU)
  max_workers: 4                             # تعداد هسته‌های CPU برای بک‌تست موازی

# ================= بخش لاگینگ و اطلاع‌رسانی =================
# تنظیمات مربوط به ثبت وقایع (Logging)
logging:
  level: 'INFO'                              # سطح لاگ: DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s' # فرمت پیام‌های لاگ
  file: 'logs/crypto_bot.log'                # مسیر فایل لاگ (اگر نمی‌خواهید در فایل ذخیره شود، null یا حذف کنید)
  rotate: True                               # استفاده از چرخش فایل لاگ برای جلوگیری از فایل‌های بزرگ
  max_size: 10485760                         # اندازه حداکثر فایل لاگ قبل از چرخش (10MB)
  backup_count: 5                            # تعداد فایل‌های لاگ پشتیبان که نگهداری می‌شود

# تنظیمات کلی اطلاع‌رسانی (Notifications)
notification:
  enabled: False                              # فعال/غیرفعال کردن کلی سیستم اطلاع‌رسانی
  channels:                                  # تنظیمات کانال‌های اطلاع‌رسانی
    telegram:
      enabled: False                         # فعال کردن اعلان تلگرام
      token: 'YOUR_TELEGRAM_BOT_TOKEN'       # توکن ربات تلگرام
      chat_id: 'YOUR_TELEGRAM_CHAT_ID'       # شناسه چت یا کانال تلگرام
    discord:
      enabled: False                         # فعال کردن اعلان دیسکورد
      webhook_url: 'YOUR_DISCORD_WEBHOOK_URL' # آدرس Webhook دیسکورد
  events:                                    # رویدادهایی که باعث ارسال اعلان می‌شوند
    signal_generated: False                  # اعلان به ازای هر سیگنال (ممکن است زیاد باشد)
    trade_opened: True                       # اعلان هنگام باز شدن معامله جدید
    trade_closed: True                       # اعلان هنگام بسته شدن معامله
    stop_loss_hit: True                      # اعلان هنگام فعال شدن حد ضرر
    take_profit_hit: True                    # اعلان هنگام فعال شدن حد سود
    trailing_stop_updated: False             # اعلان هر بار که حد ضرر متحرک جابجا می‌شود
    config_changed: True                     # اعلان هنگام تغییر تنظیمات سیستم
  min_signal_score: 35.0                     # حداقل امتیاز سیگنال برای ارسال اعلان

# ================= بخش تنظیمات هسته سیستم =================
# تنظیمات مربوط به عملکرد کلی و منابع سیستم
core:
  max_workers: 8                             # حداکثر تعداد ترد (Worker) برای پردازش موازی
  max_concurrent_analysis: 8                 # حداکثر تعداد نمادهایی که همزمان تحلیل می‌شوند
  main_loop_interval: 300                    # فاصله زمانی چرخه اصلی پردازش (ثانیه)
  use_shared_session: True                   # استفاده از یک نشست HTTP مشترک برای کل سیستم

# ================= بخش ذخیره‌سازی =================
# تنظیمات مربوط به محل ذخیره فایل‌ها و داده‌ها
storage:
  database_path: 'data/trades.db'            # مسیر فایل دیتابیس SQLite معاملات
  save_signal_history: True                  # ذخیره تاریخچه تمام سیگنال‌های تولید شده
  save_charts: True                          # ذخیره نمودارها در حین معاملات یا بک‌تست
  charts_directory: 'data/charts'            # پوشه ذخیره نمودارها

# ================= بخش مدیریت تنظیمات =================
# تنظیمات مربوط به مدیریت خودکار تنظیمات و به‌روزرسانی آنها در زمان اجرا
config_management:
  auto_reload: True                          # بررسی خودکار تغییرات در فایل تنظیمات
  check_interval_seconds: 30                 # فاصله زمانی بررسی تغییرات (ثانیه)
  notify_changes: True                       # ارسال اعلان هنگام تشخیص تغییرات
  backup_before_update: True                 # ایجاد پشتیبان قبل از اعمال تغییرات جدید
  apply_changes_immediately: True            # اعمال فوری تغییرات در حافظه بدون نیاز به راه‌اندازی مجدد
  sections_requiring_restart:                # بخش‌هایی که تغییر آنها نیاز به راه‌اندازی مجدد دارد
    - 'exchange.api_key'                     # کلید API صرافی (حساس از نظر امنیتی)
    - 'exchange.api_secret'                  # کلید مخفی API (حساس از نظر امنیتی)
    - 'exchange.api_passphrase'              # رمز عبور API (حساس از نظر امنیتی)
    - 'data_fetching.market_type'            # نوع بازار (فیوچرز/اسپات)
    - 'data_fetching.primary_api'            # API اصلی برای دریافت داده‌ها
    - 'data_fetching.cache.use_redis'        # تنظیمات پایه‌ای کش
    - 'storage.database_path'                # مسیر دیتابیس (نیاز به بازگشایی مجدد)

# ================= بخش تنظیمات Trading Brain AI =================
# تنظیمات مربوط به مدل‌های هوش مصنوعی، یادگیری ماشین و بهینه‌سازی پارامترها
trading_brain_ai:
  enabled: False                              # فعال/غیرفعال کردن کلی ماژول هوش مصنوعی
  initial_training_enabled: False            # فعال/غیرفعال کردن آموزش اولیه مدل‌ها (در شروع ربات)
  models_dir: 'models/trading_brain'         # پوشه ذخیره مدل‌های آموزش دیده هوش مصنوعی
  data_dir: 'data/trading_brain'             # پوشه ذخیره داده‌های مرتبط با هوش مصنوعی

  # تنظیمات مهندسی ویژگی (Feature Engineering)
  feature_engineering:
    use_technical_indicators: True           # استفاده از اندیکاتورهای تکنیکال به عنوان ویژگی
    use_price_patterns: True                 # استفاده از الگوهای قیمتی به عنوان ویژگی
    use_volatility_features: True            # استفاده از ویژگی‌های مرتبط با نوسان
    use_volume_features: True                # استفاده از ویژگی‌های مرتبط با حجم معاملات
    lookback_window: 20                      # تعداد کندل گذشته برای استخراج ویژگی
    target_horizons: [1, 5]                  # افق‌های پیش‌بینی (تعداد کندل آینده)
    scaler_type: 'robust'                    # نوع مقیاس‌بندی داده‌ها: 'standard', 'minmax', 'robust'
    feature_selection: True                  # فعال کردن انتخاب خودکار ویژگی‌های مهم
    feature_selection_method: 'importance'   # روش انتخاب ویژگی (فعلاً فقط 'importance')
    importance_threshold: 0.01               # حداقل اهمیت ویژگی برای انتخاب شدن

  # تنظیمات مدل‌های پیش‌بینی مختلف
  prediction_models:
    lstm:                                    # مدل شبکه عصبی LSTM (مناسب برای داده‌های سری زمانی)
      enabled: True                          # فعال/غیرفعال کردن این نوع مدل
      units: [64, 32]                        # تعداد واحدهای هر لایه LSTM
      dropout: 0.2                           # نرخ Dropout برای جلوگیری از Overfitting
      learning_rate: 0.001                   # نرخ یادگیری در آموزش مدل
      batch_size: 32                         # اندازه دسته‌های آموزشی
      epochs: 100                            # تعداد دورهای آموزش
      patience: 10                           # تعداد دورهای انتظار برای Early Stopping
      bidirectional: True                    # استفاده از LSTM دوطرفه

    transformer:                             # مدل Transformer (مناسب برای روابط پیچیده و طولانی)
      enabled: False                         # فعلاً غیرفعال
      embedding_dim: 64                      # بعد embedding
      num_heads: 4                           # تعداد سرهای توجه (Attention)
      ff_dim: 64                             # بعد لایه Feed Forward
      num_transformer_blocks: 2              # تعداد بلوک‌های Transformer
      mlp_units: [32]                        # واحدهای لایه‌های MLP نهایی
      dropout_rate: 0.25                     # نرخ Dropout
      learning_rate: 0.001                   # نرخ یادگیری
      batch_size: 32                         # اندازه دسته آموزشی
      epochs: 100                            # تعداد دورهای آموزش
      patience: 10                           # تعداد دورهای انتظار برای Early Stopping

    cnn:                                     # مدل شبکه عصبی کانولوشنی (مناسب برای الگوهای محلی)
      enabled: False                         # فعلاً غیرفعال
      filters: [64, 128]                     # تعداد فیلترها در هر لایه
      kernel_sizes: [3, 3]                   # اندازه کرنل‌ها
      pool_sizes: [2, 2]                     # اندازه Max Pooling
      dense_units: [64]                      # واحدهای لایه‌های متصل
      dropout_rate: 0.3                      # نرخ Dropout
      learning_rate: 0.001                   # نرخ یادگیری
      batch_size: 32                         # اندازه دسته آموزشی
      epochs: 100                            # تعداد دورهای آموزش
      patience: 10                           # تعداد دورهای انتظار برای Early Stopping

    xgboost:                                 # مدل XGBoost (الگوریتم درخت تصمیم تقویت شده - قدرتمند و سریع)
      enabled: True                          # فعال/غیرفعال کردن این نوع مدل
      n_estimators: 100                      # تعداد درخت‌های تصمیم
      max_depth: 5                           # حداکثر عمق هر درخت
      learning_rate: 0.1                     # نرخ یادگیری
      subsample: 0.8                         # نسبت نمونه‌برداری از داده‌ها
      colsample_bytree: 0.8                  # نسبت نمونه‌برداری از ستون‌ها

  # تنظیمات مدل ترکیبی (Ensemble)
  ensemble:
    method: 'weighted'                       # روش ترکیب مدل‌ها (فعلاً فقط 'weighted')
    weights:                                 # وزن پیش‌فرض هر مدل در ترکیب
      lstm: 0.5                              # وزن مدل LSTM
      xgboost: 0.5                           # وزن مدل XGBoost
    calibrate_probabilities: True            # کالیبره کردن احتمالات خروجی مدل‌ها
    min_confidence_threshold: 0.6            # حداقل اطمینان لازم برای تایید سیگنال

  # تنظیمات یادگیری آنلاین (Online Learning)
  online_learning:
    enabled: False                            # فعال/غیرفعال کردن یادگیری مداوم در زمان اجرا
    adaptation_frequency: 'after_trades'     # زمان به‌روزرسانی مدل‌ها: 'daily', 'hourly', 'after_trades'
    min_samples_for_update: 50               # حداقل تعداد نمونه جدید برای به‌روزرسانی مدل
    sample_buffer_size: 500                  # حداکثر تعداد نمونه‌های ذخیره شده در بافر
    learning_rate: 0.01                      # نرخ یادگیری برای به‌روزرسانی آنلاین (کمتر از آموزش اولیه)
    update_position_sizer: True              # به‌روزرسانی مدل تعیین اندازه معامله
    update_ensemble: True                    # به‌روزرسانی وزن‌های مدل ترکیبی
    use_weighted_samples: True               # وزن‌دهی به نمونه‌ها براساس تازگی یا اهمیت

  # تنظیمات تعیین‌کننده اندازه معامله (Position Sizer)
  position_sizer:
    enabled: False                           # فعلاً غیرفعال
    model_type: 'ppo'                        # نوع الگوریتم یادگیری تقویتی: 'ppo', 'a2c', 'sac'
    train_steps: 50000                       # تعداد گام‌های آموزش اولیه
    learning_rate: 0.0003                    # نرخ یادگیری
    ent_coef: 0.01                           # ضریب آنتروپی (برای تشویق اکتشاف)
    batch_size: 64                           # اندازه دسته آموزشی
    gamma: 0.99                              # ضریب تنزیل پاداش‌های آینده
    window_size: 30                          # اندازه پنجره مشاهده برای تصمیم‌گیری
    reward_scaling: 1.0                      # مقیاس‌بندی پاداش‌ها

  # تنظیمات بهینه‌سازی هایپرپارامتر
  hyperparameter_optimization:
    enabled: False                           # فعلاً غیرفعال
    n_trials: 20                             # تعداد آزمایش‌های بهینه‌سازی
    timeout: 3600                            # زمان حداکثر برای بهینه‌سازی (ثانیه)
    optimization_metric: 'accuracy'          # معیار بهینه‌سازی: 'accuracy', 'f1', 'sharpe_ratio' و...
    optimization_direction: 'maximize'       # جهت بهینه‌سازی: 'maximize' یا 'minimize'
    cv_folds: 3                              # تعداد بخش‌ها در اعتبارسنجی متقابل

# ================= بخش تنظیمات ML Signal Integration =================
# تنظیمات یکپارچه‌سازی سیگنال‌های هوش مصنوعی با سیستم معاملاتی
ml_signal_integration:
  enabled: False                              # فعال/غیرفعال کردن یکپارچه‌سازی سیگنال‌های ML
  enhance_signals: True                      # تقویت سیگنال‌های تکنیکال با پیش‌بینی‌های هوش مصنوعی
  register_trade_results: True               # ثبت نتایج معاملات برای بهبود مدل‌های ML
  sync_interval_hours: 1                     # فاصله زمانی همگام‌سازی داده‌های تاریخی (ساعت)